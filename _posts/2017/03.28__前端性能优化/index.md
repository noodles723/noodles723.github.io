---
title: "前端性能优化"
createtime: "2017-03-28"
description: "前端常见的性能优化方式"
category: ["前端"]
keywords: ["性能优化"]
cover: ""
---

目的：提升网站开启的感官速度
决定因素：
- 加载：体积，策略，速度
- 解析：内容，大小
- 渲染：复杂度

<!-- more -->

## 体积
程序体积：
- 删：没用的不引入，能不用就不用，体积小的优先
- 压：图片使劲压(有损)，颜色少png，颜色多jpg，文本也要压

传输体积：缓存+gzip

极限缓存：
- 无脑长缓存+版本号 可以让缓存失效（有多少个跟缓存有关的头？）
- 自建缓存 localstorage innerdb
- 程序离线
- 接口离线 service worker 判断请求从哪取
- 预加载

## 策略
布局优先：结构和对应样式先行，隐藏结构样式置后，行为置后
首屏优先：结构+样式

## 速度
CDN，有免费的cnd可用于博客：
- 就近交付
- 高质量网络
- cookie-free
- 突破并发限制
- 中国到美国最短150ms

协议：
- 预加载
- HTTP keep-alive
- chunked编码 边接收边解析
- http2 请求数很多的情况优化明显
- https优化

## 解析和渲染
- 不同格式解码速度不同
- 图像重新取样需要花时间，尽量使用图片的原始大小
- 画幅越大性能越差
- DOM越复杂越慢
- 样式越复杂越慢，css是从右往左解析的，选择器应该从粗到细
- 特定样式非常耗性能，如圆角、阴影

## 体验
16ms帧时间 fps62.5 requestAnimationFrame让浏览器调度动画

100ms可感知时间：人的意识在100ms内是无感知的
- 及时响应 交互反馈
- 逻辑拆开 分片执行
- 用worker 执行纯计算操作
- 干掉300ms点击延迟

400ms反应时间：开始觉得奇怪的时间
- 明确的信息反馈 
- loading态提示 
- 控制动画时长在此范围内

4000ms产生情感的时间：会有本能反应 觉得尴尬喜爱之类的
- 时间预期
- 进度条

## 性能检测工具
- yslow
- Google pagespeed insights（https://developers.google.com/speed/pagespeed/insights/?hl=zh-CN）

